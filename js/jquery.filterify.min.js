(function(b){b.fn.filterify=function(h){return this.each(function(){var g=[],d=[],e=[],f=[],k=[],a=/between-[0-9]+-[1-9]+/g;if(b(this).is("table")){var q=b(this);void 0!=h?(void 0==h.columns&&(h.columns="all"),void 0==h.emptyValue&&(h.emptyValue="Show everything")):h={columns:"all",emptyValue:"Show everything"};switch(!0){case "all"==h.columns:a=b(this).find("tr").first();0<a.find("td").length?a.find("td").each(function(c){k.push(c);g.push(b(this));d.push([]);e.push([]);f.push("all")}):a.find("th").each(function(c){k.push(c);
g.push(b(this));d.push([]);e.push([]);f.push("all")});break;case "except-first"==h.columns:a=b(this).find("tr").first();0<a.find("td").length?a.find("td:gt(0)").each(function(c){k.push(c+1);g.push(b(this));d.push([]);e.push([]);f.push("all")}):a.find("th:gt(0)").each(function(c){k.push(c+1);g.push(b(this));d.push([]);e.push([]);f.push("all")});break;case "except-last"==h.columns:a=b(this).find("tr").first();0<a.find("td").length?a.find("td:lt("+(a.find("td").length-1)+")").each(function(c){k.push(c);
g.push(b(this));d.push([]);e.push([]);f.push("all")}):a.find("th:lt("+(a.find("th").length-1)+")").each(function(c){k.push(c);g.push(b(this));d.push([]);e.push([]);f.push("all")});break;case "except-first-and-last"==h.columns:a=b(this).find("tr").first();0<a.find("td").length?a.find("td:lt("+(a.find("td").length-1)+"):gt(0)").each(function(c){k.push(c+1);g.push(b(this));d.push([]);e.push([]);f.push("all")}):a.find("th:lt("+(a.find("th").length-1)+"):gt(0)").each(function(c){k.push(c+1);g.push(b(this));
d.push([]);e.push([]);f.push("all")});break;case a.test(h.columns):var a=b(this).find("tr").first(),m=h.columns.substr(8),m=m.split("-").map(Number);0<a.find("td").length?a.find("td:lt("+m[1]+"):gt("+m[0]+")").each(function(c){k.push(c+(m[0]+1));g.push(b(this));d.push([]);e.push([]);f.push("all")}):a.find("th:lt("+m[1]+"):gt("+m[0]+")").each(function(c){k.push(c+(m[0]+1));g.push(b(this));d.push([]);e.push([]);f.push("all")});break;default:var r=h.columns.split(",").map(Number),a=/[0-9,]+/g;a.test(h.columns)?
(a=b(this).find("tr").first(),0<a.find("td").length?a.find("td").each(function(c){0<=b.inArray(c+1,r)&&(k.push(c),g.push(b(this)),d.push([]),e.push([]),f.push("all"))}):a.find("th").each(function(c){0<=b.inArray(c+1,r)&&(k.push(c),g.push(b(this)),d.push([]),e.push([]),f.push("all"))})):(a=this.find("tr").first(),0<a.find("td").length?a.find("td").each(function(c){k.push(c);g.push(b(this));d.push([]);e.push([]);f.push("all")}):a.find("th").each(function(c){k.push(c);g.push(b(this));d.push([]);e.push([]);
f.push("all")}))}var p=1;b(this).find("tr:gt(0)").each(function(){var c=b(this),a=0;b(this).find("td").each(function(f){0<=b.inArray(f,k)&&(0==b(this).find("li").length?("undefined"==typeof d[a]&&d.push([]),d[a].push(b(this).text()),void 0==e[a][b(this).text()]&&(e[a][b(this).text()]="filterify-"+p,p++),c.addClass(e[a][b(this).text()])):b(this).find("li").each(function(){"undefined"==typeof d[a]&&d.push([]);d[a].push(b(this).text());void 0==e[a][b(this).text()]&&(e[a][b(this).text()]="filterify-"+
p,p++);c.addClass(e[a][b(this).text()])}),a++)})});for(var l=0;l<g.length;l++){g[l].append('<select class="filterify-select" rel="'+l+'"><option value="all">'+h.emptyValue+"</option></select>");d[l].sort(naturalSort);for(var n=0;n<d[l].length;n++){var s=!1;g[l].find("select").first().find("option").each(function(){if(b(this).val()==e[l][d[l][n]])return s=!0,!1});s||g[l].find("select").first().append('<option value="'+e[l][d[l][n]]+'">'+d[l][n]+"</option>")}}b(this).find("select").each(function(){b(this).change(function(){var a=
b(this).val();f[b(this).attr("rel")]=a;for(var a=!0,d=0;d<f.length;d++)if("all"!=f[d]){a=!1;break}a?q.find("tr:gt(0)").each(function(){b(this).css("display","table-row")}):q.find("tr:gt(0)").each(function(){for(var a=!0,c=0;c<f.length;c++)if("all"!=f[c]&&!b(this).hasClass(f[c])){a=!1;break}a?b(this).css("display","table-row"):b(this).css("display","none")})})})}})}})(jQuery);
